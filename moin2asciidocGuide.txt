moin2asciidoc for Grandma
=========================

*How to convert pipawiki pages to asciidoc*

*and help Lumiera to move the docs to uWiki*

NOTE: This guide is based on Ubuntu

[TOC]

1. Install the conversion script
--------------------------------

 * Download the conversion script with the following terminal command:
 
 wget http://lists.lumiera.org/pipermail/lumiera-work/attachments/20080906/f0e616f6/attachment.txt
 
 * Install it with the following command:
 
 sudo mv attachment.txt /usr/local/bin/moin2asciidoc
 
 * Set the correct permissions with:
 
 chmod +x /usr/local/bin/moin2asciidoc

2. Get a git repo to collect the converted files
------------------------------------------------

 * Install git with:
 
 sudo apt-get install git-core
 
 * Get the moinmoin2asciidoc mob repo with :
 
 git clone git://git.lumiera.org/moinmoin2asciidoc/mob

3. Get a wiki file to convert
-----------------------------

 * Have a look at the http://www.pipapo.org/pipawiki/Lumiera[entry page] of the Lumiera section of the Pipapo Wiki. 
 * In the search field at the top right enter the following command:  `title:Lumiera -title:Logos -title:Names -title:NamingProcess -r:asciidoced` + 
Then click on _Titles_ for a short list and on _Text_ for a verbose list of pages still to be converted. Most of them belongs to the folder _Lumiera/DesignProcess_.
The quick way to that page is just a click on the following link:
 
http://www.pipapo.org/pipawiki?action=fullsearch&context=180&value=title%3ALumiera+-title%3ALogos+-title%3ANames+-title%3ANamingProcess+-r%3Aasciidoced&fullsearch=Text[]

 * Click on a _Lumiera/DesignProcess_ and pay attention to the _State_ written in the header table:
  -  _Final_, _Parked_ and _Dropped_ are pages that can be converted.
  - _Idea_ or _Draft_ are pages in flux and should be the very last ones to be converted.
 * Select _Raw text_ from the _More Actions_ drop down menu and make sure that there are no coments that tells the page has already been converted. E.g.: 
 
  ##asciidoced by alcarinque. Notify him if you edit.
  
 * In Firefox go to _File -> Save page as..._  and save the Raw text as a file with no extension inside the _mob_ folder.

 * If there are no _Lumiera/DesignProcess_ pages left, convert other pages.

4. Convert the file to asciidoc markup
--------------------------------------

 * Enter the mob directory with:
 
 cd mob
 
 * Run the conversion script with the following command (replace `wikifile` with the name of the wikifile - remember you can do that with _drag and drop_ the file icon into the terminal):
 
 moin2asciidoc wikifile
 
 * Admire the just created file with .txt extension.

5. Correct the asciidoc markup manually
---------------------------------------
 * Install asciidoc with
 
  sudo apt-get install asciidoc

 * Learn the basics of asciidoc using this http://powerman.name/doc/asciidoc[cheatsheet] or the complete http://www.methods.co.nz/asciidoc/userguide.html[User Guide]. 

 * Convert the .txt file to .html with asciidoc (replace `file.txt` with the name of the file to convert):
 
 asciidoc file.txt
 
 * If you get an error about section title out of sequence, you need to edit the file and fix it. Make sure you get the correct order of titles (e.g. no level 2 without a level 1 first). See the http://powerman.name/doc/asciidoc#_headers[cheatsheet] to know more.

 * Repeat the process of running and fixing untill you can run asciidoc with no errors.

 * Make sure the .txt document starts with the document header (required). See the http://powerman.name/doc/asciidoc#_document_header_required[cheatsheet] to know more.
 
 * If the wiki file has a header table, convert it using the asciidoc markup like in the example below:
 
 [grid="all"]
 `------------`-----------------------
 *State*         _Final_
 *Date*          _2007-06-29_
 *Proposed by*   link:ct[]
 -------------------------------------
 
 * Open the converted HTML file in Firefox and make sure it is nicely formatted. If you don't like it, tweak the code to make it nicer. You might want to compare the wiki page and your local HTML in two separate Firefox windows.
 
6. Put the file in place and mark it
------------------------------------

 * Once you are happy with the conversion and formatting, open the ListOfPages file and mark your wiki page as converted (c). 
 
 * Move the final .txt file in the correct folder inside the _Lumiera_ folder of the mob repo.
 
 * Delete the original wiki file (the one with no extension).
 
 * Delete the asciidoc created HTML file.
 
 * Go to the original page at Pipawiki and mark it as converted. Using the _Edit (text)_ mode, add a comment at the beginning. Add your name and your e-mail (or raffa's mail if you prefer). Something like:
 
  ##asciidoced by raffa. Please, notify any editing to raffa[AT]lumiera.org
  
7. Commit and push to git
-------------------------  

 * Make sure you are in the _mob_ git repo. If not, enter it with 
 
  cd mob
  
 * Check the status of the repo with
 
 git status
 
 * Add the new files to the index:
 
 git add file.txt
 
 * Commit your changes and comment it. Add your commit message after the -m option, leaving the second line blank. Don't forget quotation marks!
 
  git commit -m "Short description
  
  detailed description of the commit"
  
 * If you can't commit and get an error about trailing whitespaces, fix the file in your text editor, add it and commit it again.
 
 * If you can't commit because you get a  unresolved merge conflict error in line 2, you need to help git not to take the asciidoc header markup =========== for a conflict.
Disable the pre-commit hook with the following command:

 chmod -x .git/hooks/pre-commit

 * Mirror your changed repo to http://www.lumiera.org/gitweb?p=moinmoin2asciidoc/mob;a=summary[Lumiera Gitweb] with:
 
 git push
 
 
.Thanks for your contribution, Grandma! 

:-)

NOTE: Command line lovers can find some more tips http://lists.lumiera.org/pipermail/lumiera-work/2008-September/000018.html[here].
